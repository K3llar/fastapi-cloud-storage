# FastAPI Cloud Storage

Проект представляет собой личное файловое хранилище, которое позволяет размещать на сервере различные типы файлов - документы, фотографии и прочие.

## Стек технологий

- FastAPI
- PostgreSQL
- SQLAlchemy
- Alembic
- Uvicorn

Проект разворачивается на сервере с помощью:

- Docker
- Github-actions

## Описание задания

Реализовать **http-сервис**, который обрабатывает поступающие запросы. Сервер стартует по адресу `http://127.0.0.1:8080`.

<details>
<summary> Список реализованных эндпойнтов </summary>

1. Регистрация пользователя.

```
POST /register
```
Регистрация нового пользователя. Запрос принимает на вход логин и пароль для создания новой учетной записи.


2. Авторизация пользователя.

```
POST /auth
```
Запрос принимает на вход логин и пароль учетной записи и возвращает авторизационный токен. Далее все запросы проверяют наличие токена в заголовках - `Authorization: Bearer <token>`


3. Информация о загруженных файлах

```
GET /files/list
```
Вернуть информацию о ранее загруженных файлах. Доступно только авторизованному пользователю.

**Response**
```json
[
  {
    "path": "string",
    "file_id": "string",
    "file_name": "string",
    "create_date": "2022-11-29T17:49:01.185Z",
    "file_size": 0,
    "is_downloadable": true,
    "user_id": "string"
  }
]
```


4. Загрузить файл в хранилище

```
POST /files/upload
```
Метод загрузки файла в хранилище. Доступно только авторизованному пользователю.
Для загрузки заполняется полный путь до файла, в который будет загружен/переписан загружаемый файл. Если нужные директории не существуют, то они будут созданы автоматически.
Так же, есть возможность указать путь до директории. В этом случае имя создаваемого файла будет создано в соответствии с текущим передаваемым именем файла.

**Request parameters**
```
{
    "path": <full-path-to-save-file>||<path-to-folder>,
}
```
**Response**
```json
{
    "id": "a19ad56c-d8c6-4376-b9bb-ea82f7f5a853",
    "name": "notes.txt",
    "created_ad": "2020-09-11T17:22:05Z",
    "path": "/homework/test-fodler/notes.txt",
    "size": 8512,
    "is_downloadable": true
}
```


5. Скачать загруженный файл

```
GET /files/download
```
Скачивание ранее загруженного файла. Доступно только авторизованному пользователю. Возможна загрузка в архиве.

Дополнительно в `path` можно указать путь до директории. При скачивании директории будут загружаться все файлы, находящиеся в ней, в сжатом виде.

**Path parameters**
```
{
    "path": '/?path=<path-to-file>',
    "compression": bool
}
```






6. Поиск файлов по заданным параметрам

```
POST /files/search
```
Возвращает информацию о загруженных файла в по заданным параметрам. Доступно только авторизованному пользователю.

**Request**
```json
{
    "search_query": "string",
    "options": {
        "path": <folder-id-to-search>,
        "extension": <file-extension>,
        "order_by": <field-to-order-search-result>,
        "limit": <max-number-of-results>
    },
}
```

**Response**
```json
[
  {
    "path": "string",
    "file_id": "string",
    "file_name": "string",
    "create_date": "2022-11-29T17:58:05.372Z",
    "file_size": 0,
    "is_downloadable": true,
    "user_id": "string"
  }
]
```

</details>
